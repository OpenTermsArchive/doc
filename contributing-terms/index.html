<!doctype html><html lang=en><head><meta charset=utf-8><title>Open Terms Archive - Contributing terms</title><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="/css/loader.min.ca92c1a7804f2e7bd9ab5796a635b95c6ec04243851c23aa4845f82931dd4c0c.css" integrity="sha256-ypLBp4BPLnvZq1eWpjW5XG7AQkOFHCOqSEX4KTHdTAw="><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/site.webmanifest><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#000><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"></head><body><div class="container container__hasNoPaddingY container__hasNoPaddingX container__fluid"><div class="container container__1211 container__flex container__hasNoPaddingX container__hasNoPaddingY"><header class=header><div class=header_logo><a href=https://opentermsarchive.org/en/><div class="logo logo__medium"><svg><use href="#logo"/></svg></div></a></div><div class=header_menus><nav class="headerMenu headerMenu__primary"><ul><li><a href=https://opentermsarchive.org/en/datasets/>Datasets</a></li><li><a href=https://opentermsarchive.org/en/memos/>Memos</a></li><li><a href=/>Documentation</a></li><li><a href=https://opentermsarchive.org/en/impact/>Impact</a></li><li><a href=https://opentermsarchive.org/en/about/>About</a></li></ul></nav><nav class="headerMenu headerMenu__secondary"><div class=languageSwitcher><button class=languageSwitcher_current>
EN<svg class="icon_arrowDown"><use href="#arrowDown"/></svg></button><div class=languageSwitcher_items><div class=languageSwitcher_item><a href=/fr/>FR</a></div></div></div><ul><li><a class=icon_circle target=_blank rel=noopener href=https://mastodon.lescommuns.org/@opentermsarchive><svg class="icon icon--fill-white"><use href="#mastodon"/></svg></a></li><li><a class=icon_circle target=_blank rel=noopener title="View source code" href=https://github.com/OpenTermsArchive><svg class="icon_github"><use href="#github"/></svg></a></li></ul></nav></div><button type=button class=header_openLink>
Menu</button>
<button type=button class=header_closeLink>
Close<svg class="icon_close"><use href="#close"/></svg></button></header></div></div><div class="container container__hasNoPaddingTop"><div class="container container__1211 container__flex container__hasPaddingYSmall"><aside class=aside><nav class=aside_nav><ul class=aside_items><li class=aside_item><a href=/>Getting started</a></li><li class=aside_item><a href=/navigate-history/>Browsing through terms</a></li><li class=aside_item><a href=/subscribe-rss/>Subscribing to terms changes</a></li><li class="aside_item aside_item-current"><a href=/contributing-terms/>Contributing terms</a><nav id=TableOfContents><ul><li><a href=#tracking-new-terms>Tracking new terms</a></li><li><a href=#declaring-terms>Declaring terms</a></li><li><a href=#maintaining-declarations>Maintaining declarations</a></li></ul></nav></li><li class=aside_item><span class=aside_item_section>Collections</span><ul class=aside_subitems><li class=aside_subitem><a href=/collections/metadata/>Metadata</a></li><li class=aside_subitem><a href=/collections/governance/>Governance</a></li><li class=aside_subitem><a href=/collections/create/>Creating a collection</a></li><li class=aside_subitem><a href=/collections/federation/>Federation</a></li></ul></li><li class=aside_item><span class=aside_item_section>API</span><ul class=aside_subitems><li class=aside_subitem><a href=/api/node/>Node</a></li><li class=aside_subitem><a href=/api/collection/>Collection</a></li><li class=aside_subitem><a href=/api/federated/>Federated</a></li></ul></li><li class=aside_item><span class=aside_item_section>Guidelines</span><ul class=aside_subitems><li class=aside_subitem><a href=/guidelines/choosing-selectors/>Choosing selectors</a></li><li class=aside_subitem><a href=/guidelines/declaring/>Declaring documents</a></li><li class=aside_subitem><a href=/guidelines/reviewing/>Reviewing contributions</a></li><li class=aside_subitem><a href=/guidelines/targeting/>Targeting</a></li></ul></li><li class=aside_item><a href=/design-principles/>Design principles</a></li></ul></nav></aside><div class=textContent><h1 id=contributing-terms>Contributing terms</h1><h2 id=tracking-new-terms>Tracking new terms</h2><p>Tracking terms is done by <em>declaring</em> them and the service they are associated with. Such a declaration is achieved by editing JSON files in the <a href=https://github.com/OpenTermsArchive/contrib-declarations/tree/main/declarations><code>declarations</code></a> folder.</p><p>Before adding new terms, open the <a href=https://github.com/OpenTermsArchive/contrib-declarations/tree/main/declarations><code>declarations</code></a> folder and check if the service you want to track terms for is already declared. If a JSON file with the name of the service is already present, you can jump straight to <a href=#declaring-terms>declaring terms</a>. Otherwise, keep reading!</p><h3 id=declaring-a-new-service>Declaring a new service</h3><p>Before declaring a service, you will need to choose the service name and service ID. The service ID will be the name of the JSON file in which the service will be declared. It is a normalised version of the service name.</p><h3 id=service-name>Service name</h3><p>The service name is exposed to end users. It should reflect as closely as possible the official service name, as referenced in the terms or ‚Äúabout‚Äù pages, so that it can be recognised easily and unambiguously.</p><ul><li>The service name should be the one used by the service itself, no matter the alphabet, UTF symbols, spaces, and casing.<ul><li><em>Example: <code>eBay</code></em>.</li><li><em>Example: <code>hi5</code></em>.</li><li><em>Example: <code>LINE</code></em>.</li><li><em>Example: <code>App Store</code></em>.</li><li><em>Example: <code>—Ç—É—Ç—É.—Ä—É</code> (Cyrillic)</em>.</li><li><em>Example: <code>ÊäñÈü≥Áü≠ËßÜÈ¢ë</code> (Simplified Chinese characters)</em>.</li></ul></li><li>Domain name extensions (TLDs) are allowed when they are part of the official service name.<ul><li><em>Example: <code>Booking.com</code></em>.</li><li><em>Example: <code>historiel√¶rer.dk</code></em>.</li></ul></li><li>Service names can be prefixed by the provider name, separated by a space, when it would otherwise be too generic or ambiguous.<ul><li><em>Example: <code>Ads</code> (by Facebook) ‚Üí <code>Facebook Ads</code></em>.</li><li><em>Example: <code>Analytics</code> (by Google) ‚Üí <code>Google Analytics</code></em>.</li><li><em>Example: <code>Firebase</code> (by Google) ‚Üí <code>Firebase</code></em>.</li><li><em>Example: <code>App Store</code> (by Apple) ‚Üí <code>App Store</code></em>.</li></ul></li></ul><blockquote><p>If you have a hard time finding the service name, check out the <a href=../guidelines/declaring#service-name>practical guidelines to find the service name</a>, and feel free to mention your uncertainties in the pull request! We will help you improve the service name if necessary üôÇ</p></blockquote><h3 id=service-id>Service ID</h3><p>The service ID is exposed to developers. It should be easy to handle with scripts and other tools.</p><ul><li>Non-ASCII characters are not supported. Service IDs are derived from the service name by normalising it into ASCII.<ul><li><em>Example: <code>RT√â</code> ‚Üí <code>RTE</code></em>.</li><li><em>Example: <code>historiel√¶rer.dk</code> ‚Üí <code>historielaerer.dk</code></em>.</li><li><em>Example: <code>—Ç—É—Ç—É.—Ä—É</code> ‚Üí <code>tutu.ru</code></em>.</li><li><em>Example: <code>ÊäñÈü≥Áü≠ËßÜÈ¢ë</code> ‚Üí <code>Douyin</code></em>.</li></ul></li><li>Punctuation is supported, except characters that have meaning at filesystem level (<code>:</code>, <code>/</code>, <code>\</code>). These are replaced with a dash (<code>-</code>). The dot (<code>.</code>) is supported, but the service ID cannot be solely <code>.</code> or <code>..</code> as these have specific meanings in the filesystem.<ul><li><em>Example: <code>Booking.com</code> ‚Üí <code>Booking.com</code></em>.</li><li><em>Example: <code>Yahoo!</code> ‚Üí <code>Yahoo!</code></em>.</li><li><em>Example: <code>re:start</code> ‚Üí <code>re-start</code></em>.</li><li><em>Example: <code>we://</code> ‚Üí <code>we---</code></em>.</li></ul></li><li>Capitals and spaces are supported. Casing and spacing are expected to reflect the official service name casing and spacing.<ul><li><em>Example: <code>App Store</code> ‚Üí <code>App Store</code></em>.</li><li><em>Example: <code>DeviantArt</code> ‚Üí <code>DeviantArt</code></em>.</li></ul></li></ul><blockquote><p>If you have a hard time defining the service ID, check out the <a href=../guidelines/declaring#service-id>practical guidelines to derive the ID from the service name</a>, and feel free to mention your uncertainties in the pull request! We will help you improve the service ID if necessary üôÇ</p></blockquote><blockquote><p>More details on the ID and naming constraints and recommendations can be found in the relevant <a href=https://github.com/OpenTermsArchive/engine/blob/main/decision-records/0001-service-name-and-id.md>decision record</a>.</p></blockquote><h3 id=service-declaration>Service declaration</h3><p>Once you have the <a href=#service-name>service name</a> and the <a href=#service-id>service ID</a>, create a JSON file in the <code>declarations</code> folder named after the ID of the service you want to add, with the following structure:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;service name&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;documents&#34;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Within the <code>documents</code> JSON object, you will now declare terms.</p><hr><h2 id=declaring-terms>Declaring terms</h2><p>Terms are declared in a service declaration file, under the <code>documents</code> property.</p><p>Most of the time, terms are written in only one source document (for example <a href=https://www.facebook.com/legal/terms>Facebook Terms of Service</a>) but sometimes terms can be spread across multiple online source documents, and their combination constitutes the terms (for example <a href=https://transparency.fb.com/policies/community-standards/>Facebook Community Guidelines</a>).</p><h4 id=source-document>Source document</h4><p>The way in which a source document is obtained is defined in a JSON object:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;The URL where the document can be found&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;A boolean to execute client-side JavaScript loaded by the document before accessing the content, in case the DOM modifications are needed to access the content; defaults to false (fetch HTML only)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;An array of service specific filter function names&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;A CSS selector, a range selector or an array of selectors that target the insignificant parts of the document that has to be removed. Useful to remove parts that are inside the selected parts&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;A CSS selector, a range selector or an array of selectors that target the meaningful parts of the document, excluding elements such as headers, footers and navigation&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>For HTML files, <code>fetch</code> and <code>select</code> are mandatory.</li><li>For PDF files, only <code>fetch</code> is mandatory.</li></ul><p>Let‚Äôs start by defining these keys!</p><h4 id=fetch><code>fetch</code></h4><p>This property should simply contain the URL at which the terms you want to track can be downloaded. HTML and PDF files are supported.</p><p>When terms coexist in different languages and jurisdictions, please refer to the <a href=../#collections>scope of the collection</a> to which you are contributing. This scope is usually defined in the README.</p><h4 id=select><code>select</code></h4><p><em>This property is not needed for PDF documents.</em></p><p>Most of the time, contractual documents are exposed as web pages, with a header, a footer, navigation menus, possibly ads‚Ä¶ We aim at tracking only the significant parts of the document. In order to achieve that, the <code>select</code> property allows to extract only those parts in the process of <a href=https://opentermsarchive.org/#how-it-works>converting from snapshot to version</a>.</p><p>The <code>select</code> value can be either a <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors>CSS selector</a>, a <a href=#range-selectors>range selector</a> or an array of those.</p><h5 id=css-selectors>CSS selectors</h5><p>CSS selectors should be provided as a string. See the <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors>specification</a> for how to write CSS selectors.</p><blockquote><p>For example, the following selector will select the content in the <code>&lt;main></code> tag of the HTML document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;select&#34;</span><span class=err>:</span> <span class=s2>&#34;main&#34;</span>
</span></span></code></pre></div></blockquote><h5 id=range-selectors>Range selectors</h5><p>A range selector is defined with a <em>start</em> and an <em>end</em> CSS selector. It is also necessary to define if the range starts before or after the element targeted by the <em>start</em> CSS selector and to define if it ends before or after the element targeted by the <em>end</em> CSS selector.</p><p>To that end, a range selector is a JSON object containing two keys out of the four that are available: <code>startBefore</code>, <code>startAfter</code>, <code>endBefore</code> and <code>endAfter</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start[Before|After]&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;CSS selector&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;end[Before|After]&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;CSS selector&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>For example, the following selector will select the content between the element targeted by the CSS selector <code>#privacy-eea</code>, including it, and the element targeted by the CSS selector <code>footer</code>, excluding it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;startBefore&#34;</span><span class=p>:</span> <span class=s2>&#34;#privacy-eea&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;endBefore&#34;</span><span class=p>:</span> <span class=s2>&#34;footer&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></blockquote><h4 id=remove><code>remove</code></h4><p><em>This property is optional.</em></p><p>Beyond <a href=#select>selecting a subset of a web page</a>, some documents will have non-significant parts in the middle of otherwise significant parts. For example, they can have ‚Äúgo to top‚Äù links or banner ads. These can be removed by listing <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors>CSS selectors</a>, <a href=#range-selectors>range selectors</a> or an array of them under the <code>remove</code> property.</p><h5 id=example>Example</h5><p>Let&rsquo;s assume a web page contains the following content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>main</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;filter-holder&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>select</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;filter-options&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;https://www.example.com/policies/user-agreement&#34;</span> <span class=na>selected</span><span class=p>&gt;</span>User Agreement<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;https://www.example.com/policies/privacy-policy&#34;</span><span class=p>&gt;</span>Privacy Policy<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;https://www.example.com/policies/content-policy&#34;</span><span class=p>&gt;</span>Content Policy<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;https://www.example.com/policies/broadcasting-content-policy&#34;</span><span class=p>&gt;</span>Broadcasting Content Policy<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>User Agreement<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>‚Ä¶terms‚Ä¶<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>main</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>If only <code>main</code> is used in <code>select</code>, the following version will be extracted:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-md data-lang=md><span class=line><span class=cl>User Agreement Privacy Policy Content Policy Broadcasting Content Policy Moderator Guidelines Transparency Report 2017 Transparency Report 2018 Guidelines for Law Enforcement Transparency Report 2019
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User Agreement
</span></span><span class=line><span class=cl>==============
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>‚Ä¶terms‚Ä¶
</span></span></code></pre></div><p>Whereas we want instead:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-md data-lang=md><span class=line><span class=cl>User Agreement
</span></span><span class=line><span class=cl>==============
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>‚Ä¶terms‚Ä¶
</span></span></code></pre></div><p>This result can be obtained with the following declaration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;https://example.com/user-agreement&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;.filter-holder&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=complex-selectors-examples>Complex selectors examples</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;https://support.google.com/adsense/answer/48182&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;.article-container&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;.print-button, .go-to-top&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;https://www.wechat.com/en/service_terms.html&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;#agreement&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;startBefore&#34;</span><span class=p>:</span> <span class=s2>&#34;#wechat-terms-of-service-usa-specific-terms-&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;endBefore&#34;</span><span class=p>:</span> <span class=s2>&#34;#wechat-terms-of-service-european-union-specific-terms-&#34;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;https://fr-fr.facebook.com/legal/terms/plain_text_terms&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;div[role=main]&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;startBefore&#34;</span><span class=p>:</span> <span class=s2>&#34;[role=\&#34;separator\&#34;]&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;endAfter&#34;</span><span class=p>:</span> <span class=s2>&#34;body&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>},</span>
</span></span><span class=line><span class=cl>   <span class=s2>&#34;[style=\&#34;display:none\&#34;]&#34;</span>
</span></span><span class=line><span class=cl> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=executeclientscripts><code>executeClientScripts</code></h4><p><em>This property is optional.</em></p><p>In some cases, the content of the document is only loaded (or is modified dynamically) by client scripts.
When set to <code>true</code>, this boolean property loads the page in a headless browser to load all assets and execute client scripts before trying to get the document contents.</p><p>Since the performance cost of this approach is high, it is set to <code>false</code> by default, relying on the HTML content only.</p><h4 id=filter><code>filter</code></h4><p><em>This property is optional.</em></p><p>Finally, some documents will need more complex filtering beyond simple element selection and removal, for example to remove noise (changes in textual content that are not meaningful to the terms of services). Such filters are declared as JavaScript functions that modify the downloaded web page through the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model>DOM API</a>.</p><p>Filters take the document DOM and the terms declaration as parameters and are:</p><ul><li><strong>in-place</strong>: they modify the document structure and content directly;</li><li><strong>idempotent</strong>: they should return the same document structure and content even if run repeatedly on their own result.</li></ul><p>Filters are loaded automatically from files named after the service they operate on. For example, filters for the Meetup service, which is declared in <code>declarations/Meetup.json</code>, are loaded from <code>declarations/Meetup.filters.js</code>.</p><p>The generic function signature for a filter is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=p>[</span><span class=kr>async</span><span class=p>]</span> <span class=kd>function</span> <span class=nx>filterName</span><span class=p>(</span><span class=nb>document</span><span class=p>,</span> <span class=nx>documentDeclaration</span><span class=p>)</span>
</span></span></code></pre></div><p>Each filter is exposed as a named function export that takes a <code>document</code> parameter and behaves like the <code>document</code> object in a browser DOM. These functions can be <code>async</code>, but they will still run sequentially. The whole document declaration is passed as second parameter.</p><blockquote><p>The <code>document</code> parameter is actually a <a href=https://github.com/jsdom/jsdom>JSDOM</a> document instance.</p></blockquote><p>You can learn more about usual noise and ways to handle it <a href=../guidelines/declaring#usual-noise>in the guidelines</a>.</p><h5 id=example-1>Example</h5><p>Let&rsquo;s assume a service adds a unique <code>clickId</code> parameter in the query string of all link destinations. These parameters change on each page load, leading to recording noise in versions. Since links should still be recorded, it is not appropriate to use <code>remove</code> to remove the links entirely. Instead, a filter will manipulate the links destinations to remove the always-changing parameter. Concretely, the goal is to apply the following filter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>- Read the &lt;a href=&#34;https://example.com/example-page?clickId=349A2033B&amp;lang=en&#34;&gt;list of our affiliates&lt;/a&gt;.
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+ Read the &lt;a href=&#34;https://example.com/example-page?lang=en&#34;&gt;list of our affiliates&lt;/a&gt;.
</span></span></span></code></pre></div><p>The code below implements this filter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>removeTrackingIdsQueryParam</span><span class=p>(</span><span class=nb>document</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>QUERY_PARAM_TO_REMOVE</span> <span class=o>=</span> <span class=s1>&#39;clickId&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>).</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>link</span> <span class=p>=&gt;</span> <span class=p>{</span>  <span class=c1>// iterate over every link in the page
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>link</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;href&#39;</span><span class=p>),</span> <span class=nb>document</span><span class=p>.</span><span class=nx>location</span><span class=p>);</span>  <span class=c1>// URL is part of the DOM API, see https://developer.mozilla.org/en-US/docs/Web/API/URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>params</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>search</span><span class=p>);</span>  <span class=c1>// URLSearchParams is part of the DOM API, see https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>params</span><span class=p>.</span><span class=k>delete</span><span class=p>(</span><span class=nx>QUERY_PARAM_TO_REMOVE</span><span class=p>);</span>  <span class=c1>// we use the DOM API instead of RegExp because we can&#39;t know in advance in which order parameters will be written
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>url</span><span class=p>.</span><span class=nx>search</span> <span class=o>=</span> <span class=nx>params</span><span class=p>.</span><span class=nx>toString</span><span class=p>();</span>  <span class=c1>// store the query string without the parameter
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>link</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;href&#39;</span><span class=p>,</span> <span class=nx>url</span><span class=p>.</span><span class=nx>toString</span><span class=p>());</span>  <span class=c1>// write the destination URL without the parameter
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h5 id=example-usage-of-declaration-parameter>Example usage of declaration parameter</h5><p>The second parameter can be used to access the defined document URL or selector inside the filter.</p><p>Let&rsquo;s assume a service stores some of its legally-binding terms in images. To track these changes properly, images should be stored as part of the terms. By default, images are not stored since they significantly increase the document size. The filter below will store images inline in the terms, encoded in a <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs>data URL</a>. In order to download the images for conversion, the base URL of the web page is needed to resolve relative links. This information is obtained from the declaration.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=nx>fetch</span> <span class=nx>from</span> <span class=s1>&#39;isomorphic-fetch&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>async</span> <span class=kd>function</span> <span class=nx>convertImagesToBase64</span><span class=p>(</span><span class=nb>document</span><span class=p>,</span> <span class=nx>documentDeclaration</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>fetch</span><span class=o>:</span> <span class=nx>baseUrl</span><span class=p>,</span> <span class=nx>select</span><span class=o>:</span> <span class=nx>selector</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>documentDeclaration</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>images</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>selector</span><span class=si>}</span><span class=sb> img`</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>(</span><span class=nx>images</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=kr>async</span> <span class=p>({</span> <span class=nx>src</span> <span class=p>},</span> <span class=nx>index</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>imageAbsoluteUrl</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span> <span class=nx>baseUrl</span><span class=p>).</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>imageAbsoluteUrl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>mimeType</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;content-type&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>content</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>arrayBuffer</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>base64Image</span> <span class=o>=</span> <span class=nx>btoa</span><span class=p>(</span><span class=nb>String</span><span class=p>.</span><span class=nx>fromCharCode</span><span class=p>(...</span><span class=k>new</span> <span class=nx>Uint8Array</span><span class=p>(</span><span class=nx>content</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>images</span><span class=p>[</span><span class=nx>index</span><span class=p>].</span><span class=nx>src</span> <span class=o>=</span> <span class=sb>`data:</span><span class=si>${</span><span class=nx>mimeType</span><span class=si>}</span><span class=sb>;base64,</span><span class=si>${</span><span class=nx>base64Image</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=terms-with-a-single-source-document>Terms with a single source document</h4><p>In the case where terms are extracted from one single source document, they are declared by simply declaring that source document:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;documents&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;&lt;terms type&gt;&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span></code></pre></div><h4 id=terms-with-multiple-source-documents>Terms with multiple source documents</h4><p>When the terms are spread across multiple source documents, they should be declared by declaring their combination:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;documents&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;&lt;terms type&gt;&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;combine&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span></code></pre></div><p>If some parts of the source documents are repeated, they can be factorised. For example, it is common for the structure of HTML pages to be similar from page to page, so <code>select</code>, <code>remove</code> and <code>filter</code> would be the same. These elements can be shared instead of being duplicated:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;documents&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;&lt;terms type&gt;&#34;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>      <span class=s2>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;combine&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;‚Ä¶&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span></code></pre></div><h4 id=terms-type>Terms type</h4><p>Great, your terms declaration is now almost complete! You simply need to write it under the appropriate terms type in the <code>documents</code> JSON object within the service declaration.</p><p>In order to distinguish between the many terms that can be associated with a service and enable cross-services comparison of similar terms, we maintain a unique list of terms types in a <a href=https://github.com/OpenTermsArchive/terms-types>dedicated repository</a>.</p><p>Please note, the terms type may differ from the exact name provided by the service, but it should align with the underlying commitment. For example, some providers might call ‚ÄúTerms and Conditions‚Äù or ‚ÄúTerms of Use‚Äù what some others call ‚ÄúTerms of Service‚Äù.</p><p>If the terms you want to add don&rsquo;t match an existing type, you can <a href=https://github.com/OpenTermsArchive/terms-types/blob/main/CONTRIBUTING.md>suggest a new one</a>.</p><h3 id=testing-your-declaration>Testing your declaration</h3><p>You can test the declarations you created or changed by running the following command:</p><pre tabindex=0><code>npm test [$service_id [$another_service_id ‚Ä¶]]
</code></pre><p>Since this operation fetches documents and could be long, you can also validate the declaration structure only:</p><pre tabindex=0><code>npm run test:schema [$service_id [$another_service_id ‚Ä¶]]
</code></pre><h4 id=linting>Linting</h4><p>In order to ensure consistency across declarations, all declarations files have to be formatted homogeneously.</p><p>In order to achieve this, you can use the following command:</p><pre tabindex=0><code>npm run lint [$service_id [$another_service_id ‚Ä¶]]
</code></pre><hr><h2 id=maintaining-declarations>Maintaining declarations</h2><p>All parts of a <strong>terms</strong> <strong>declaration</strong> (web location, selection, noise removal, distribution across multiple documents‚Ä¶) can change over time. The process of updating these elements to enable continued <strong>tracking</strong> is called <strong>maintenance</strong>. Without it, <strong>terms</strong> can become:</p><ul><li><strong>unreachable</strong>: no <strong>snapshot</strong> can be <strong>recorded</strong> at all, because the <strong>location</strong> changed or the <strong>service</strong> denies access;</li><li><strong>unextractable</strong>: no <strong>version</strong> can be <strong>extracted</strong> from the <strong>snapshot</strong>, because the selection of content or some <strong>filter</strong> fails;</li><li><strong>noisy</strong>: both <strong>snapshots</strong> and <strong>versions</strong> are <strong>recorded</strong> but the <strong>changes</strong> contain <strong>noise</strong> that should have been <strong>filtered out</strong>.</li></ul><p>Open Terms Archive needs to keep track of this changes in order to regenerate versions history from snapshots history.</p><h3 id=service-history>Service history</h3><p>To keep track of services declarations and filters changes, Open Terms Archive offers a versioning system. It is optional and should be added only when needed. It works by creating history files for terms declarations and filters, where each entry should be a previous valid declaration or filter function and should have an expiry date.</p><p>Both for terms and filters history, the expiration date is declared in a property <code>validUntil</code>. It should be the authored date and time of the last snapshot commit for which the declaration is still valid.</p><p>Terms declarations history files and filters history files can both evolve on their own. Having one does not imply to create the other.</p><p>The current (latest) valid declaration has no date and should not appear in the history object: it stays in its own file, just like if there was no history at all.</p><h4 id=terms-declaration-history>Terms declaration history</h4><p>Declarations history are stored in a history JSON file with the following name <code>declarations/$service_id.history.json</code>.</p><p>The terms history contains an object with terms types as properties. Each terms type property is an array of history entries. Each entry has the same format as a normal terms declaration, except there is the <strong>mandatory</strong> extra property <code>validUntil</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;&lt;terms type&gt;&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;The URL where the document can be found&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;executeClientScripts&#34;</span><span class=p>:</span> <span class=s2>&#34;A boolean to execute client-side JavaScript loaded by the document before accessing the content, in case the DOM modifications are needed to access the content; defaults to false (fetch HTML only)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=s2>&#34;An array of service specific filter function names&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;remove&#34;</span><span class=p>:</span> <span class=s2>&#34;A CSS selector, a range selector or an array of selectors that target the insignificant parts of the document that has to be removed. Useful to remove parts that are inside the selected parts&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;A CSS selector, a range selector or an array of selectors that target the meaningful parts of the document, excluding elements such as headers, footers and navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;validUntil&#34;</span><span class=p>:</span> <span class=s2>&#34;The inclusive expiration date in ISO format&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=err>‚Ä¶</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>For example, to add a history entry for the <code>Terms of Service</code> of the service <code>ASKfm</code>, create the file <code>declarations/ASKfm.history.json</code> with the following contents:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Terms of Service&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;fetch&#34;</span><span class=p>:</span> <span class=s2>&#34;https://ask.fm/docs/terms_of_use/?lang=en&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;select&#34;</span><span class=p>:</span> <span class=s2>&#34;body&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;add&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;validUntil&#34;</span><span class=p>:</span> <span class=s2>&#34;2020-10-29T21:30:00.000Z&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=filters-history>Filters history</h4><p>Filters history is declared in a filters history declaration JavaScript file with the following name: <code>declarations/$service_id.filters.history.js</code>.</p><p>For each filter, a variable named like the filter must be exported. This variable should contain an array of filter history entries. Each entry is an object with the expiration date, as <code>validUntil</code> property, and the valid function for this date, under the <code>filter</code> property. Both properties are <strong>mandatory</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=o>&lt;</span><span class=nx>filterName</span><span class=o>&gt;</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>validUntil</span><span class=o>:</span> <span class=s2>&#34;The inclusive expiration date in ISO format&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>filter</span><span class=o>:</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span> <span class=cm>/* body valid until the expiration of the `validUntil` date */</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span></code></pre></div><p>For example, to add a history entry for the <code>removeSharesButton</code> filter of the service <code>ASKfm</code>, create the file <code>declarations/ASKfm.filters.history.js</code> with the following content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>export</span> <span class=kr>const</span> <span class=nx>removeSharesButton</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>validUntil</span><span class=o>:</span> <span class=s1>&#39;2020-08-22T11:30:21.000Z&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>filter</span><span class=o>:</span> <span class=kr>async</span> <span class=p>(</span><span class=nb>document</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;.shares&#39;</span><span class=p>).</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>element</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>element</span><span class=p>.</span><span class=nx>remove</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span></code></pre></div><h3 id=handling-a-terminated-service>Handling a terminated service</h3><p>If the service provider stops offering a service, the associated terms will become unavailable. To mark that service termination in Open¬†Terms¬†Archive and ensure tracking tentatives are stopped, while maintaining the possibility to explore the history:</p><ol><li>Move the existing documents declaration to the service <a href=#terms-declaration-history>history file</a>.</li><li>Update the declaration to stop tracking all terms, by removing every <code>&lt;terms type></code> entries from the <code>documents</code> key in the declaration:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;service name&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;documents&#34;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=renaming-a-service>Renaming a service</h3><p>The consensus is to consider that a service provider renaming a service (for example, <code>Twitter</code> to <code>X</code>) is akin to terminating the previous service and opening a new one. Therefore, to apply a service renaming, open a pull request that both <a href=#handling-terminated-service>terminates the previous service</a> and adds a new <a href=#declaring-a-new-service>service declaration</a> with the new service name. You can reuse the <code>documents</code> part of the original declaration, but should double-check that the selectors and URLs still match, as a service rename is most often accompanied by a new page layout, a new domain name, and sometimes entirely new terms.</p></div></div></div><div class="container container__hasNoPaddingY container__fluid container__hasNoPaddingX container__isGray"><div class=divider><hr></div><div class="container container__flex container__1211 container__hasNoPaddingX container__hasPaddingYSmall"><footer class=footer><div class="logo logo__medium"><svg class="icon_logo"><use href="#logo"/></svg></div><div class=footer_menus><div class=footerMenu><ul><li><a href=https://opentermsarchive.org>Home</a></li><li><a href=https://opentermsarchive.org/en/datasets/>Datasets</a></li><li><a href=https://opentermsarchive.org/en/memos/>Memos</a></li><li><a href=/>Documentation</a></li><li><a href=https://opentermsarchive.org/en/impact/>Impact</a></li><li><a href=https://opentermsarchive.org/en/about/>About</a></li></ul><ul><li><a target=_blank rel=noopener class="a_icontext a__small footer_menus_icontext" href=https://mastodon.lescommuns.org/@opentermsarchive><span class="icon_circle icon_circle__medium mr__2XS"><svg class="icon icon--fill-white"><use href="#mastodon"/></svg></span><span>Follow us</span></a></li><li><a title="Contactez nous par email" class="a_icontext a__small footer_menus_icontext" href=mailto:contact@opentermsarchive.org><span class="icon_circle icon_circle__medium mr__2XS"><svg class="icon_contact"><use href="#contact"/></svg></span><span>Contact us</span></a></li></ul></div><div class="footerMenu footerMenu__isSmall footerMenu__alignRight"><ul><li><a href=https://opentermsarchive.org/en/stats/>Statistics</a></li><li><a href=https://opentermsarchive.org/en/media/>Media</a></li><li><a href=https://github.com/OpenTermsArchive>Source code</a></li></ul><ul><li><a href=https://opentermsarchive.org/en/legal-notice/>Legal notice</a></li><li><a href=https://opentermsarchive.org/en/privacy-policy/>Privacy policy</a></li><li><a href=https://opentermsarchive.org/en/accessibility/>Accessibility: not compliant</a></li></ul></div></div></footer></div></div><script src=/js/languageSwitcher.js></script>
<script src=/js/header.js></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["setExcludedQueryParams",["simulationId","_csrf"]]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://stats.data.gouv.fr/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","179"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><svg aria-hidden="true" id="svgdefs" version="2" xmlns="http://www.w3.org/2000/svg"><defs><symbol id="logo" fill="#010613" viewBox="0 0 406 52"><path d="M92.13 25.546c0-6.187-3.842-9.714-8.855-9.714-5.041.0-8.855 3.527-8.855 9.713.0 6.159 3.814 9.713 8.855 9.713 5.013.0 8.854-3.527 8.854-9.713zm-4.054.0c0 4.007-1.902 6.176-4.801 6.176-2.909.0-4.801-2.17-4.801-6.177s1.892-6.176 4.8-6.176c2.9.0 4.802 2.17 4.802 6.177zM97.301 35h3.998v-6.13h3.36c4.349.0 6.879-2.595 6.879-6.371.0-3.758-2.484-6.408-6.777-6.408h-7.46zm3.998-9.335V19.36h2.696c2.308.0 3.425 1.256 3.425 3.14.0 1.874-1.117 3.167-3.407 3.167zM116.345 35h12.778v-3.296h-8.78v-4.515h8.088v-3.296h-8.088v-4.506h8.743v-3.296h-12.741zm33.946-18.91h-3.98v11.893h-.166l-8.162-11.892h-3.508V35h3.998V23.099h.138L146.838 35h3.453zm13.02 3.297h5.789V35h3.952V19.387h5.789v-3.296h-15.53zM183.609 35h12.778v-3.296h-8.781v-4.515h8.088v-3.296h-8.088v-4.506h8.744v-3.296h-12.741zm18.129.0h3.998v-6.703h2.918L212.236 35h4.414l-4.017-7.35c2.152-.923 3.343-2.797 3.343-5.382.0-3.758-2.484-6.177-6.777-6.177h-7.461zm3.998-9.916v-5.725h2.696c2.309.0 3.426 1.025 3.426 2.909.0 1.874-1.117 2.816-3.407 2.816zm15.275-8.993V35h3.878V22.646h.157l4.893 12.262h2.641l4.893-12.216h.157V35h3.878V16.09h-4.93l-5.208 12.706h-.221l-5.208-12.705zm36.259 5.438h3.831c-.055-3.37-2.825-5.697-7.035-5.697-4.146.0-7.183 2.29-7.165 5.725-.009 2.788 1.958 4.386 5.152 5.152l2.059.517c2.059.498 3.204 1.09 3.213 2.364-.009 1.384-1.32 2.326-3.351 2.326-2.078.0-3.574-.96-3.703-2.853h-3.868c.101 4.09 3.028 6.205 7.617 6.205 4.616.0 7.331-2.207 7.34-5.67-.009-3.148-2.382-4.819-5.669-5.557l-1.699-.407c-1.643-.378-3.019-.988-2.991-2.345.0-1.219 1.08-2.114 3.037-2.114 1.911.0 3.084.868 3.232 2.354zM277.746 35l1.403-4.312h6.823L287.376 35h4.284l-6.519-18.91h-5.151L273.462 35zm2.419-7.433 2.327-7.155h.147l2.327 7.155zM296.146 35h3.998v-6.703h2.917L306.644 35h4.413l-4.016-7.35c2.151-.923 3.342-2.797 3.342-5.382.0-3.758-2.484-6.177-6.777-6.177h-7.46zm3.998-9.916v-5.725h2.696c2.308.0 3.425 1.025 3.425 2.909.0 1.874-1.117 2.816-3.407 2.816zm31.958-2.373c-.526-4.367-3.831-6.879-8.208-6.879-4.995.0-8.808 3.527-8.808 9.713.0 6.168 3.749 9.713 8.808 9.713 4.848.0 7.774-3.222 8.208-6.703l-4.044-.018c-.378 2.022-1.966 3.185-4.099 3.185-2.872.0-4.82-2.133-4.82-6.177.0-3.933 1.921-6.176 4.848-6.176 2.188.0 3.767 1.265 4.071 3.342zM337.179 35h3.998v-7.811h8.116V35h3.988V16.09h-3.988v7.803h-8.116V16.09h-3.998zm25.606-18.91h-3.997V35h3.997zm8.916.0h-4.441L373.788 35h5.152l6.518-18.91h-4.432l-4.579 14.367h-.176zM389.944 35h12.778v-3.296h-8.78v-4.515h8.088v-3.296h-8.088v-4.506h8.743v-3.296h-12.741zM5 31 .67 23.5h8.66z"/><path d="M4.759 25.146c-.962-.034-1.72-.842-1.621-1.799a26 26 0 1112.57 24.998c-.826-.492-1.023-1.583-.477-2.375s1.628-.984 2.46-.501A22.516 22.516.0 106.628 23.47c-.108.956-.908 1.709-1.869 1.675z"/><path d="M23.002 17.631c0-.93.754-1.684 1.684-1.684h12.632a1.684 1.684.0 110 3.369H24.686c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.684 1.684-1.684h9.926a1.684 1.684.0 110 3.368h-9.926c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.684 1.684-1.684h11.632a1.684 1.684.0 010 3.368H24.686c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.685 1.684-1.685h3.652a1.684 1.684.0 110 3.369h-3.652c-.93.0-1.684-.754-1.684-1.684z"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#999" style="color:#999" height="1em" width="1em" id="arrowDown"><polyline points="6 9 12 15 18 9"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="close"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="contact"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></symbol><symbol id="mastodon" fill="var(--svgfill)" viewBox="0 0 24 24"><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792.0 11.813.0h-.03c-3.98.0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057.0 00.023-.043v-1.809a.052.052.0 00-.02-.041.053.053.0 00-.046-.01 20.282 20.282.0 01-4.709.545c-2.73.0-3.463-1.284-3.674-1.818a5.593 5.593.0 01-.319-1.433.053.053.0 01.066-.054c1.517.363 3.072.546 4.632.546.376.0.75.0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23.0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112.0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311.0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13.0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/></symbol></defs></svg></body></html>