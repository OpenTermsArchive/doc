<!doctype html><html lang=en><head><meta charset=utf-8><title>Creating a collection</title><meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="/css/loader.min.b9e99845db6bcdf788e1e1e27a03aa1afc8d590e8be99d6f1c6a78ce29dab8be.css" integrity="sha256-uemYRdtrzfeI4eHiegOqGvyNWQ6L6Z1vHGp4zinauL4="><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/site.webmanifest><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#000><meta name=msapplication-TileColor content="#ffffff"><meta name=theme-color content="#ffffff"></head><body><div class="container container__hasNoPaddingY container__hasNoPaddingX container__fluid"><div class="container container__1211 container__flex container__hasNoPaddingX container__hasNoPaddingY"><header class=header><div class=header_logo><a href=https://opentermsarchive.org/en/><div class="logo logo__medium"><svg><use href="#logo"/></svg></div></a></div><div class=header_menus><nav class="headerMenu headerMenu__primary"><ul><li><a href=https://opentermsarchive.org/en/datasets/>Datasets</a></li><li><a href=https://opentermsarchive.org/en/memos/>Memos</a></li><li><a href=/>Documentation</a></li><li><a href=https://opentermsarchive.org/en/impact/>Impact</a></li><li><a href=https://opentermsarchive.org/en/about/>About</a></li></ul></nav><nav class="headerMenu headerMenu__secondary"><div class=languageSwitcher><button class=languageSwitcher_current>
EN<svg class="icon_arrowDown"><use href="#arrowDown"/></svg></button><div class=languageSwitcher_items><div class=languageSwitcher_item><a href=/fr/>FR</a></div></div></div><ul><li><a class=icon_circle target=_blank rel=noopener href=https://mastodon.social/@opentermsarchive><svg class="icon icon--fill-white"><use href="#mastodon"/></svg></a></li><li><a class=icon_circle target=_blank rel=noopener title="View source code" href=https://github.com/OpenTermsArchive><svg class="icon_github"><use href="#github"/></svg></a></li></ul></nav></div><button type=button class=header_openLink>
Menu</button>
<button type=button class=header_closeLink>
Close<svg class="icon_close"><use href="#close"/></svg></button></header></div></div><div class="container container__hasNoPaddingTop"><div class="container container__1211 container__flex container__hasPaddingYSmall"><aside class=aside><nav class=aside_nav><ul class=aside_items><li class=aside_item><a href=/>Getting started</a></li><li class=aside_item><span class=aside_item_section>Terms</span><ul class=aside_subitems><li class=aside_subitem><a href=/terms/how-to-navigate-history/>How to navigate history</a></li><li class=aside_subitem><a href=/terms/tracking-new-terms/>Tracking new terms</a></li><li class=aside_subitem><a href=/terms/declarations-maintenance/>Declarations maintenance</a></li><li class=aside_subitem><a href=/terms/reference/>Reference</a></li><li class=aside_subitem><a href=/terms/how-to-add-terms-using-with-the-graphical-contribution-interface/>How to add terms with the graphical contribution interface</a></li><li class=aside_subitem><a href=/terms/how-to-be-notified-of-terms-changes/>How to be notified of terms changes</a></li></ul></li><li class="aside_item aside_item-current"><span class=aside_item_section>Collections</span><ul class=aside_subitems><li class=aside_subitem><a href=/collections/metadata/>Metadata</a></li><li class=aside_subitem><a href=/collections/governance/>Governance</a></li><li class=aside_subitem><a href=/collections/create/>Creating a collection</a><nav id=TableOfContents><ul><li><a href=#define-metadata>Define metadata</a></li><li><a href=#check-existing-collections>Check existing collections</a></li><li><a href=#inform-the-community>Inform the community</a></li><li><a href=#define-governance>Define governance</a></li><li><a href=#create-repositories>Create repositories</a></li><li><a href=#set-up-github-teams>Set up GitHub teams</a></li><li><a href=#set-up-deployment>Set up deployment</a></li><li><a href=#test>Test</a></li></ul></nav></li><li class=aside_subitem><a href=/collections/federation/>Federation</a></li></ul></li><li class=aside_item><span class=aside_item_section>API</span><ul class=aside_subitems><li class=aside_subitem><a href=/api/node/>Node</a></li><li class=aside_subitem><a href=/api/collection/>Collection</a></li><li class=aside_subitem><a href=/api/federation/>Federation</a></li></ul></li><li class=aside_item><span class=aside_item_section>Guidelines</span><ul class=aside_subitems><li class=aside_subitem><a href=/guidelines/choosing-selectors/>Choosing selectors</a></li><li class=aside_subitem><a href=/guidelines/declaring/>Declaring documents</a></li><li class=aside_subitem><a href=/guidelines/reviewing/>Reviewing contributions</a></li><li class=aside_subitem><a href=/guidelines/targeting/>Targeting</a></li></ul></li><li class=aside_item><span class=aside_item_section>Memos</span><ul class=aside_subitems><li class=aside_subitem><a href=/memos/copywriting-reference/>Copywriting reference</a></li><li class=aside_subitem><a href=/memos/how-to-publish/>How to publish a memo</a></li></ul></li><li class=aside_item><span class=aside_item_section>Community</span><ul class=aside_subitems><li class=aside_subitem><a href=/community/how-to-join-mattermost/>How to join Mattermost</a></li></ul></li><li class=aside_item><a href=/design-principles/>Design principles</a></li></ul></nav></aside><div class=textContent><h1 id=creating-a-collection>Creating a collection</h1><p>You are considering creating a new collection to track terms with OpenÂ TermsÂ Archive? Amazing!</p><h2 id=define-metadata>Define metadata
<a class=title-anchor href=#define-metadata>ğŸ”—</a></h2><p>First of all, define the <a href=/collections/metadata/>metadata</a> of the collection you would like to create.</p><h2 id=check-existing-collections>Check existing collections
<a class=title-anchor href=#check-existing-collections>ğŸ”—</a></h2><p>Now that you have a clear idea what you would like to track, double-check that there are no <a href=https://opentermsarchive.org/#collections>existing federated collections</a> that you could contribute to. If you have a doubt about whether some terms you want to track would fit a collection, reach out to the collection maintainers.</p><p>If no existing collection could be a good host for the terms you would like to track, then it is relevant to create your own.</p><h2 id=inform-the-community>Inform the community
<a class=title-anchor href=#inform-the-community>ğŸ”—</a></h2><p>Starting a new collection is an exciting endeavour, and would strongly benefit from the support of the community who already maintains existing collections. It is strongly recommended to share your intention to create a new collection as early as possible in the process, to get support and identify potential partners.</p><p>You can inform the community by posting on the instant messaging system, or <a href=mailto:contact@opentermsarchive.org>sending an email</a> to the core team.</p><h2 id=define-governance>Define governance
<a class=title-anchor href=#define-governance>ğŸ”—</a></h2><p>Setting up and maintaining a collection over time needs fulfilling certain tasks on a regular basis. These tasks are handled through roles. To make sure that all these roles are covered, define the <a href=/collections/governance/>governance</a> of your collection.</p><p>At any time, feel free to ask for help or partners in the community.</p><h2 id=create-repositories>Create repositories
<a class=title-anchor href=#create-repositories>ğŸ”—</a></h2><p>Collections rely on three git repositories being set up to hold the data.</p><p>The instructions below assume the usage of GitHub to host repositories. If you don&rsquo;t use GitHub, try to set up the equivalent metadata in your git hosting platform. Contributions to the documentation to make it independent from GitHub are very welcome!</p><h3 id=declarations>Declarations
<a class=title-anchor href=#declarations>ğŸ”—</a></h3><p>Create the collection declarations repository by using the <a href=https://github.com/OpenTermsArchive/demo-declarations><code>demo-declarations</code></a> repository as template.</p><ul><li>Go to the <a href=https://github.com/OpenTermsArchive/demo-declarations><code>demo-declarations</code> repository</a></li><li>Click on the â€œUse this templateâ€ dropdown and select â€œCreate a new repositoryâ€</li><li>Set the repository name to <code>&lt;collection_id>-declarations</code>. For example: <code>pga-declarations</code>.</li><li>When redirected to the newly generated repository, wait a minute or two for the automatic setup to run. You can check the status of the <code>first-time-setup</code> GitHub action to make sure that everything ran fine.</li></ul><h4 id=fill-the-about-section>Fill the â€œAboutâ€ section
<a class=title-anchor href=#fill-the-about-section>ğŸ”—</a></h4><ul><li>Click on the little cogwheel icon next to the â€œAboutâ€ block.</li><li>Set the description to â€œDeclarations for <code>&lt;collection_name></code>. Maintained by <code>&lt;maintainer></code>.â€</li><li>Set website to <code>https://opentermsarchive.org</code>, or any other relevant dedicated website.</li><li>Add the following tags: <code>terms-of-service</code>, <code>terms-of-service-agreements</code>, <code>terms-and-conditions</code>, <code>open-terms-archive</code>.</li><li>Uncheck â€œReleasesâ€, â€œPackagesâ€ and â€œDeploymentsâ€.</li></ul><h4 id=define-repository-settings>Define repository settings
<a class=title-anchor href=#define-repository-settings>ğŸ”—</a></h4><p>These settings ease the whole contribution process.</p><ul><li>In â€œGeneral â†’ Featuresâ€<ul><li>Disable â€œWikisâ€.</li><li>Disable â€œProjectsâ€.</li></ul></li><li>In â€œGeneral â†’ Pull Requestsâ€<ul><li>Check only the â€œAllow squash mergingâ€ option, and set it to â€œDefault to pull request title and commit detailsâ€.</li><li>Enable â€œAllow auto-mergeâ€.</li><li>Enable â€œAutomatically delete head branchesâ€.</li></ul></li><li>In â€œBranchesâ€<ul><li>Add a branch protection rule for <code>main</code>.<ul><li>Check â€œRequire a pull request before mergingâ€, check &ldquo;Require approvals&rdquo; and set â€œRequired number of approvals before mergingâ€ to 1.</li><li>Check â€œRequire status checks to pass before mergingâ€ and add <code>validate_modified_declarations</code> and <code>validate_schema</code> as required status checks.</li></ul></li></ul></li><li>In â€œActions â†’ General â†’ Actions permissionsâ€<ul><li>Select â€œAllow all actions and reusable workflowsâ€.</li></ul></li></ul><h4 id=remove-default-labels>Remove default labels
<a class=title-anchor href=#remove-default-labels>ğŸ”—</a></h4><p>Issues labels will be added by the engine as problems are encountered when tracking. The default labels offered by GitHub, such as <code>question</code> or <code>wontfix</code>, are relevant for software development but less so for the process prescribed by OpenÂ TermsÂ Archive.</p><ul><li>Remove all default labels.</li></ul><h4 id=update-readme>Update README
<a class=title-anchor href=#update-readme>ğŸ”—</a></h4><ul><li>Update the README file with proper metadata: topic, maintainers, jurisdictions, languagesâ€¦</li></ul><h3 id=snapshots>Snapshots
<a class=title-anchor href=#snapshots>ğŸ”—</a></h3><p>Create the snapshots repository by using the <a href=https://github.com/OpenTermsArchive/demo-snapshots><code>demo-snapshots</code> repository</a> as template:</p><ul><li>Go to the <a href=https://github.com/OpenTermsArchive/demo-snapshots><code>demo-snapshots</code> repository</a></li><li>Click on the â€œUse this templateâ€ dropdown and select â€œCreate a new repositoryâ€</li><li>Set the repository name to <code>&lt;collection_id>-snapshots</code>.</li><li>When redirected to the newly generated repository, wait a minute or two for the automatic setup to run. You can check the status of the <code>first-time-setup</code> GitHub action to make sure that everything ran fine.</li></ul><h4 id=fill-the-about-section-1>Fill the â€œAboutâ€ section
<a class=title-anchor href=#fill-the-about-section-1>ğŸ”—</a></h4><ul><li>Set the description: â€œDocuments snapshots for <code>&lt;collection_name></code>. Maintained by <code>&lt;maintainer></code>.â€</li><li>Set website to <code>https://opentermsarchive.org</code>.</li><li>Add the following tags: <code>terms-of-service</code>, <code>terms-of-service-agreements</code>, <code>terms-and-conditions</code>, <code>open-terms-archive</code>.</li><li>Uncheck â€œReleasesâ€, â€œPackagesâ€ and â€œDeploymentsâ€.</li></ul><h4 id=define-repository-settings-1>Define repository settings
<a class=title-anchor href=#define-repository-settings-1>ğŸ”—</a></h4><p>These settings aim at minimising the otherwise overwhelming amount of information and click targets.</p><ul><li>In â€œGeneral â†’ Featuresâ€<ul><li>Uncheck â€œWikisâ€.</li><li>Uncheck â€œIssuesâ€.</li><li>Uncheck â€œDiscussionsâ€.</li><li>Uncheck â€œProjectsâ€.</li></ul></li><li>In â€œActions â†’ General â†’ Actions permissionsâ€<ul><li>Select â€œDisable actionsâ€.</li></ul></li></ul><h3 id=versions>Versions
<a class=title-anchor href=#versions>ğŸ”—</a></h3><p>Create the versions repository by using the <a href=https://github.com/OpenTermsArchive/demo-versions><code>demo-versions</code> repository</a> as template:</p><ul><li>Go to the <a href=https://github.com/OpenTermsArchive/demo-versions><code>demo-versions</code> repository</a></li><li>Click on the â€œUse this templateâ€ dropdown and select â€œCreate a new repositoryâ€</li><li>Set the repository name to <code>&lt;collection_id>-versions</code>.</li><li>When redirected to the newly generated repository, wait a minute or two for the automatic setup to run. You can check the status of the <code>first-time-setup</code> GitHub action to make sure that everything ran fine.</li></ul><h4 id=fill-the-about-section-2>Fill the â€œAboutâ€ section
<a class=title-anchor href=#fill-the-about-section-2>ğŸ”—</a></h4><ul><li>Set the description: â€œTerms versions for <code>&lt;collection_name></code>. Maintained by <code>&lt;maintainer></code>.â€</li><li>Set website to <code>https://docs.opentermsarchive.org/terms/how-to-navigate-history/</code></li><li>Add the following tags: <code>terms-of-service</code>, <code>terms-of-service-agreements</code>, <code>terms-and-conditions</code>, <code>open-terms-archive</code>.</li><li>Uncheck â€œPackagesâ€.</li><li>Uncheck â€œDeploymentsâ€.</li></ul><h4 id=define-repository-settings-2>Define repository settings
<a class=title-anchor href=#define-repository-settings-2>ğŸ”—</a></h4><p>These settings aim at minimising the otherwise overwhelming amount of information and click targets.</p><ul><li>In â€œGeneral â†’ Featuresâ€<ul><li>Uncheck â€œWikisâ€.</li><li>Uncheck â€œIssuesâ€.</li><li>Uncheck â€œDiscussionsâ€.</li><li>Uncheck â€œProjectsâ€.</li></ul></li><li>In â€œActions â†’ General â†’ Actions permissionsâ€<ul><li>Select â€œDisable actionsâ€.</li></ul></li></ul><h4 id=update-readme-1>Update README
<a class=title-anchor href=#update-readme-1>ğŸ”—</a></h4><ul><li>Update the README file with proper metadata.</li></ul><h2 id=set-up-github-teams>Set up GitHub teams
<a class=title-anchor href=#set-up-github-teams>ğŸ”—</a></h2><p>For collections to be included in the Open Terms Archive organisation only. For third parties, handle rights however you see fit.</p><ul><li><a href=https://github.com/orgs/OpenTermsArchive/new-team>Create a new collection team</a></li><li>Give it the name of the collection</li><li>Set as avatar the collection icon from the website</li><li>Set as description: â€œMaintainers of the <code>&lt;collection_name></code> collectionâ€</li><li>Add selected members to the team</li><li>Add the declarations repository to the collection team, with â€œMaintainâ€ access rights</li><li>Add the snapshots repository to the collection team, with â€œTriageâ€ access rights (giving them more would enable them to corrupt data)</li><li>Add the versions repository to the collection team, with â€œTriageâ€ access rights (giving them more would enable them to corrupt data)</li><li>Add the declarations, snapshots and versions repositories to the Bots team with â€œWriteâ€ access</li></ul><h2 id=set-up-deployment>Set up deployment
<a class=title-anchor href=#set-up-deployment>ğŸ”—</a></h2><h3 id=check-server-configuration>Check server configuration
<a class=title-anchor href=#check-server-configuration>ğŸ”—</a></h3><p>Before proceeding with deployment, ensure that the server meets the following requirements:</p><ul><li><p>Verify that the server provides an Ed25519 fingerprint for its SSH host key:</p><ul><li>Retrieve the Ed25519 SSH host key from the server <code>ssh-keyscan -t ed25519 &lt;server_address></code></li><li>If the server has an Ed25519 SSH host key defined, the output will display the corresponding fingerprint. It will look something like this:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>  &lt;server_address&gt; ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJM6fCKWkiKv+uysoHsklIAuUOH6Dpc3crzHxk7GwrD
</span></span></code></pre></div><ul><li>If no output is displayed or if the output does not include an Ed25519 SSH host key fingerprint, it indicates that the server does not have an Ed25519 SSH host key defined. Here&rsquo;s an example of the output when no Ed25519 SSH host key is defined:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>  <span class=c1># &lt;server_address&gt; SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3</span>
</span></span><span class=line><span class=cl>  &lt;server_address&gt; ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDqruXk1P6vIVvN2i6ffLO6TlYCcC6lqF3oBYT7sC+nfIb5C9HYsUFWptSxohOy41wV3AbSzjHqEjxCt9MeJ4HXrLItti8Qr3fRBYgs45+L44bMZ9sA/EO+YiXQU9cQJb2qjK5EYQyFyEnGUMbh+zzRiCRQTI0A2nlnJ9zWQJr/4jIrlNJ6N0lV1GQzN/iIpCJto6ZmhbEgW5W3H+zB5qj72uKoyLlm8Lh+AF5ljtTnOuXgrh2nN6EN1hjRf52VtQZ93guIBkn5+riZ3gYYp3fl4sYbIAZRRs5rOcyFk9d/jo+kBw/Pxht4KABVHJHMPQ9cI2Fn2VbEOvZ+RrWLXc5Am3qwbUWpqYmp7n7wwdTrkYeCBMsXk7xQl5TJh+5Rkr6k0YRkcbvP+J+I1TJwob1DOyWBpRA3v9LYimEmy9eheQuKYzH5sQ/0r/7ZwhBL5/lB5kpv3kmwA7DZy1J5UbgChtSey3Du0N+6p/vgfybIgcZD5Csz8+dF3c+gZBCfRd4XpKgLoxLPZO69tM8/3z/3W0gOfXgEw6QKwJ6KoFXeBdRG9c/CCsR8dF3iIeZYWZvj+8nC/Y7hF6Dedr/6CHc0O4xwqE0GQzF3YUZI7HcqjxIIFsIsG+loUGWYB7a0HHn0FrAq79Q<span class=o>==</span>
</span></span><span class=line><span class=cl>  &lt;server_address&gt; ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLe8sKzXq4KReWp0Dz1lC8AKOcYNtPuk7GOqJRSVGkG1xRhP94gReTp7S1WnF6LgFt3vlC2k62BkSoXgryY3+8<span class=o>=</span>
</span></span></code></pre></div><ul><li>If the server does not have an Ed25519 SSH host key defined, once logged in on your server, you can generate one: <code>sudo ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key</code></li><li>Restart the SSH service to apply the changes: <code>sudo systemctl restart ssh</code></li></ul></li><li><p>Make sure that a non-root user has been set up on the server, if not you can create by following:</p><ul><li>Once logged in on your server, create a new user: <code>adduser &lt;user></code>. Follow the prompts to set a password for the new user and provide any additional information if required.</li><li>Grant sudo privileges: <code>usermod -aG sudo &lt;user></code>.</li></ul></li><li><p>Grant <code>sudo</code> rights to the designated user without requiring a password prompt. To achieve this:</p><ul><li><p>Open the file <code>/etc/sudoers</code> for editing.</p></li><li><p>Navigate to the section titled <code># Allow members of group sudo to execute any command</code>.</p></li><li><p>Add the following line at the end of this section:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&lt;user&gt;  <span class=nv>ALL</span><span class=o>=(</span>ALL<span class=o>)</span> NOPASSWD:ALL
</span></span></code></pre></div></li></ul></li></ul><h3 id=define-the-inventory>Define the inventory
<a class=title-anchor href=#define-the-inventory>ğŸ”—</a></h3><p>On your local machine:</p><ul><li>Clone the <code>&lt;collection_id>-declarations</code> repository</li><li>Update the following entries in the inventory file <code>deployment/inventory.yml</code>:<ul><li><code>&lt;host></code> (example: <code>162.19.74.224</code>)</li><li><code>ansible_user: &lt;username></code> (example: <code>debian</code>)</li><li><code>ed25519_fingerprint: &lt;server_ssh_fingerprint></code> obtained with <code>ssh-keyscan -t ed25519 &lt;host></code> (example: <code>AAAAC3NzaC1lZDI1ETE5AAAAIJkjE2KIbUcoClK+lKLR5ZvmdXMD/eXWghHdenFeJz4c</code>)</li></ul></li></ul><h3 id=add-fingerprint-to-github-collection_name-declarations-settings>Add fingerprint to GitHub &lt;collection_name>-declarations settings
<a class=title-anchor href=#add-fingerprint-to-github-collection_name-declarations-settings>ğŸ”—</a></h3><ul><li>Log in on GitHub with a user account that has admin privileges for the <code>&lt;collection_name>-declarations</code> repository</li><li>Go to <code>https://github.com/OpenTermsArchive/&lt;collection_name>-declarations/settings/secrets/actions</code></li><li>Create the <code>SERVER_FINGERPRINT</code> <a href=https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository>secrets</a> by using the previously obtained ed25519 fingerprint</li></ul><h3 id=set-up-a-ssh-deployment-key>Set up a SSH deployment key
<a class=title-anchor href=#set-up-a-ssh-deployment-key>ğŸ”—</a></h3><p>This key will enable automated deployment via GitHub Actions.</p><h4 id=create-the-ssh-key>Create the SSH key
<a class=title-anchor href=#create-the-ssh-key>ğŸ”—</a></h4><ul><li>Connect to the server: <code>ssh &lt;username>@&lt;host></code></li><li>Create a new deployment SSH key: <code>ssh-keygen -t ed25519 -q -N "" -f ~/.ssh/ota-deploy</code></li><li>Add the public key to <code>authorized_keys</code>: <code>cat ~/.ssh/ota-deploy.pub >> ~/.ssh/authorized_keys</code></li></ul><h4 id=add-key-to-github-collection_name-declarations-repository-secrets>Add key to GitHub &lt;collection_name>-declarations repository secrets
<a class=title-anchor href=#add-key-to-github-collection_name-declarations-repository-secrets>ğŸ”—</a></h4><ul><li>Log in on GitHub using a user account with admin privileges for the <code>&lt;collection_name>-declarations</code> repository</li><li>Go to <code>https://github.com/OpenTermsArchive/&lt;collection_name>-declarations/settings/secrets/actions</code></li><li>Create the <code>SERVER_SSH_KEY</code> secret with the previously generated deployment private key</li></ul><h4 id=back-key-up>Back key up
<a class=title-anchor href=#back-key-up>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Clone the <a href=https://github.com/OpenTermsArchive/engine/wiki><code>engine.wiki</code></a></li><li>Open the shared passwords database <code>database.kdbx</code> with <a href=https://keepassxc.org>KeePassXC</a></li><li>Create the <code>Collection: &lt;collection_name></code> folder</li><li>Inside this folder, add an entry with the title <code>Deployment SSH key</code></li><li>Attach public <code>ota-deploy.pub</code> and private <code>ota-deploy</code> key files to the entry</li><li>Save, commit and push</li></ul><h3 id=allow-ota-bot-to-create-issues-and-publish-dataset-on-github>Allow OTA-Bot to create issues and publish dataset on GitHub
<a class=title-anchor href=#allow-ota-bot-to-create-issues-and-publish-dataset-on-github>ğŸ”—</a></h3><h4 id=create-a-fine-grained-repo-scoped-token>Create a fine-grained repo-scoped token
<a class=title-anchor href=#create-a-fine-grained-repo-scoped-token>ğŸ”—</a></h4><ul><li>Log in on GitHub as OTA-Bot user</li><li>Go to <a href=https://github.com/settings/personal-access-tokens/new>https://github.com/settings/personal-access-tokens/new</a></li><li>Set the â€œToken nameâ€: â€œIssue/Release on <code>&lt;collection_name></code> collectionâ€</li><li>Leave blank â€œDescriptionâ€</li><li>Set the expiry date to the maximum possible (one year later at the time of writing)</li><li>In â€œResource ownerâ€, select the â€œOpenTermsArchiveâ€œ organization</li><li>Leave blank the following text area: <code>Describe why your personal access token needs access to the OpenTermsArchive organization.</code></li><li>In â€œRepository accessâ€, select â€œOnly select repositoriesâ€</li><li>In â€œSelect repositoriesâ€, Select â€œ<code>&lt;collection_name></code>-declarationsâ€ and <code>&lt;collection_name></code>-versionsâ€</li><li>In â€œPermissionsâ€ â†’ â€œRepository permissionsâ€, select â€œContents â€” Access: Read and writeâ€</li><li>In â€œPermissionsâ€ â†’ â€œRepository permissionsâ€, select â€œIssues â€” Access: Read and writeâ€</li><li>Validate with â€œGenerate token and request accessâ€</li></ul><h4 id=backup-the-token>Backup the token
<a class=title-anchor href=#backup-the-token>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Open the shared passwords database <code>database.kdbx</code> with <a href=https://keepassxc.org>KeePassXC</a></li><li>Inside the <code>Collection: &lt;collection_name></code> folder, add an entry with the title <code>GitHub Token</code></li><li>Copy the previously generated token in the <code>Password</code> field</li><li>Save, commit and push</li></ul><h4 id=validate-the-token>Validate the token
<a class=title-anchor href=#validate-the-token>ğŸ”—</a></h4><ul><li>Log in on GitHub using a user account with admin privileges for the OpenTermsArchive organization</li><li>Go to <a href=https://github.com/organizations/OpenTermsArchive/settings/personal-access-token-requests>https://github.com/organizations/OpenTermsArchive/settings/personal-access-token-requests</a></li><li>Select the pending request</li><li>Approve it</li></ul><h3 id=add-secrets>Add secrets
<a class=title-anchor href=#add-secrets>ğŸ”—</a></h3><h4 id=generate-vault-key>Generate vault key
<a class=title-anchor href=#generate-vault-key>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Open the shared passwords database <code>database.kdbx</code> with <a href=https://keepassxc.org>KeePassXC</a></li><li>Inside the <code>Collection: &lt;collection_name></code> folder, add an entry with the title <code>Vault key</code></li><li>In the password field, click on the icon on the right to generate a new password</li><li>Generate a new password that does not contain any quote or backtick</li><li>Save, commit and push</li></ul><h4 id=create-vault-key-file>Create vault key file
<a class=title-anchor href=#create-vault-key-file>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Go to the <code>&lt;collection_id>-declarations</code> repository</li><li>Go to <code>deployment</code> folder</li><li>Create a <code>vault.key</code> file</li><li>Copy the previously generated password inside</li></ul><h4 id=add-vault-key-to-github-collection_name-declarations-settings>Add vault key to GitHub &lt;collection_name>-declarations settings
<a class=title-anchor href=#add-vault-key-to-github-collection_name-declarations-settings>ğŸ”—</a></h4><ul><li>Log in on GitHub using a user account with admin privileges for the <code>&lt;collection_name>-declarations</code> repository</li><li>Go to <code>https://github.com/OpenTermsArchive/&lt;collection_name>-declarations/settings/secrets/actions</code></li><li>Create the <code>ANSIBLE_VAULT_KEY</code> <a href=https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository>secrets</a> by using the previously generated vault key</li></ul><h4 id=encrypt-token-and-update-deployment>Encrypt token and update deployment
<a class=title-anchor href=#encrypt-token-and-update-deployment>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Go to the <code>&lt;collection_id>-declarations</code> repository</li><li>Go to <code>deployment</code> folder</li><li>Paste the token in a <code>.env</code> file under the name <code>OTA_ENGINE_GITHUB_TOKEN</code></li><li>Encrypt <code>.env</code>: <code>ansible-vault encrypt .env</code></li></ul><h3 id=set-up-an-ota-bot-ssh-key-specific-to-this-collection>Set up an OTA-Bot SSH key specific to this collection
<a class=title-anchor href=#set-up-an-ota-bot-ssh-key-specific-to-this-collection>ğŸ”—</a></h3><h4 id=create-the-ssh-key-1>Create the SSH key
<a class=title-anchor href=#create-the-ssh-key-1>ğŸ”—</a></h4><ul><li>Create a new SSH key: <code>ssh-keygen -t ed25519 -C bot@opentermsarchive.org -P "" -f ./&lt;collection_name>-key</code></li><li>Copy the generated private key file</li></ul><h4 id=encrypt-private-key-and-update-deployment>Encrypt private key and update deployment
<a class=title-anchor href=#encrypt-private-key-and-update-deployment>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Go to the <code>&lt;collection_id>-declarations</code> repository</li><li>Go to <code>deployment</code> folder</li><li>Paste the private key file</li><li>Rename it into <code>github-bot-private-key</code></li><li>Encrypt key <code>github-bot-private-key</code>: <code>ansible-vault encrypt github-bot-private-key</code></li></ul><h4 id=back-key-up-1>Back key up
<a class=title-anchor href=#back-key-up-1>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Inside the <a href=https://github.com/OpenTermsArchive/engine/wiki><code>engine.wiki</code></a></li><li>Open the shared passwords database <code>database.kdbx</code> with <a href=https://keepassxc.org>KeePassXC</a></li><li>Inside the <code>Collection: &lt;collection_name></code> folder, add an entry with the title <code>OTA-Bot GitHub SSH key</code></li><li>Attach public <code>&lt;collection_name>-key.pub</code> and private <code>&lt;collection_name>-key</code> key files to the entry</li><li>Save, commit and push</li></ul><h4 id=attach-the-key-to-ota-bot-github-user>Attach the key to OTA-Bot GitHub user
<a class=title-anchor href=#attach-the-key-to-ota-bot-github-user>ğŸ”—</a></h4><ul><li>Log in on GitHub as OTA-Bot user</li><li>Go to <a href=https://github.com/settings/ssh/new>https://github.com/settings/ssh/new</a></li><li>Set the â€œTitleâ€: â€œ<code>&lt;collection_name></code> collectionâ€</li><li>Paste the public key in â€œKeyâ€</li><li>Validate with â€œAdd SSH Keyâ€</li></ul><h3 id=enable-sending-error-reports-over-email>Enable sending error reports over email
<a class=title-anchor href=#enable-sending-error-reports-over-email>ğŸ”—</a></h3><h4 id=create-an-smtp-key>Create an SMTP key
<a class=title-anchor href=#create-an-smtp-key>ğŸ”—</a></h4><p>Create an SMTP key to allow sending error notifications by email.</p><ul><li>Log in on Brevo as Open Terms Archive admin user</li><li>Go to <a href=https://app.brevo.com/settings/keys/smtp>https://app.brevo.com/settings/keys/smtp</a></li><li>â€œGenerate a new SMTP keyâ€</li><li>Set the SMTP key name â€œName your SMTP keyâ€: <code>&lt;collection_name></code> collectionâ€</li><li>Validate with â€œGenerateâ€</li></ul><h4 id=backup-key>Backup key
<a class=title-anchor href=#backup-key>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Inside the <a href=https://github.com/OpenTermsArchive/engine/wiki><code>engine.wiki</code></a></li><li>Open the shared passwords database <code>database.kdbx</code> with <a href=https://keepassxc.org>KeePassXC</a></li><li>Inside the <code>Collection: &lt;collection_name></code> folder, add an entry with the title <code>SMTP Key</code></li><li>Copy the previously generated key in the <code>Password</code> field</li><li>Save, commit and push</li></ul><h4 id=encrypt-key-and-update-deployment>Encrypt key and update deployment
<a class=title-anchor href=#encrypt-key-and-update-deployment>ğŸ”—</a></h4><p>On your local machine:</p><ul><li>Go to the <code>&lt;collection_id>-declarations</code> repository</li><li>Go to <code>deployment</code> folder</li><li>Decrypt <code>.env</code> if necessary: <code>ansible-vault decrypt .env</code></li><li>Paste the key in a <code>.env</code> file under the name <code>OTA_ENGINE_SMTP_PASSWORD</code></li><li>Encrypt <code>.env</code>: <code>ansible-vault encrypt .env</code></li></ul><h2 id=test>Test
<a class=title-anchor href=#test>ğŸ”—</a></h2><h3 id=via-github-actions>Via GitHub Actions
<a class=title-anchor href=#via-github-actions>ğŸ”—</a></h3><ul><li>Check that the <code>deploy</code> action ran properly on the declarations repository.</li></ul><h3 id=locally>Locally
<a class=title-anchor href=#locally>ğŸ”—</a></h3><p>To test deployment from your local machine, your SSH keys must be authorized to connect to the server.</p><ul><li><code>cd &lt;path/to/>&lt;collection_id>-declarations/deployment</code></li><li><code>ansible-galaxy collection install -r requirements.yml</code></li><li><code>ansible-playbook opentermsarchive.deployment.deploy</code></li></ul></div></div></div><div class="container container__hasNoPaddingY container__fluid container__hasNoPaddingX container__isGray"><div class=divider><hr></div><div class="container container__flex container__1211 container__hasNoPaddingX container__hasPaddingYSmall"><footer class=footer><div class="logo logo__medium"><svg class="icon_logo"><use href="#logo"/></svg></div><div class=footer_menus><div class=footerMenu><ul><li><a href=https://opentermsarchive.org>Home</a></li><li><a href=https://opentermsarchive.org/en/datasets/>Datasets</a></li><li><a href=https://opentermsarchive.org/en/memos/>Memos</a></li><li><a href=/>Documentation</a></li><li><a href=https://opentermsarchive.org/en/impact/>Impact</a></li><li><a href=https://opentermsarchive.org/en/about/>About</a></li></ul><ul><li><a target=_blank rel=noopener class="a_icontext a__small footer_menus_icontext" href=https://mastodon.social/@opentermsarchive><span class="icon_circle icon_circle__medium mr__2XS"><svg class="icon icon--fill-white"><use href="#mastodon"/></svg></span><span>Follow us</span></a></li><li><a title="Contactez nous par email" class="a_icontext a__small footer_menus_icontext" href=mailto:contact@opentermsarchive.org><span class="icon_circle icon_circle__medium mr__2XS"><svg class="icon_contact"><use href="#contact"/></svg></span><span>Contact us</span></a></li></ul></div><div class="footerMenu footerMenu__isSmall footerMenu__alignRight"><ul><li><a href=https://opentermsarchive.org/en/stats/>Statistics</a></li><li><a href=https://opentermsarchive.org/en/media/>Media</a></li><li><a href=https://github.com/OpenTermsArchive>Source code</a></li></ul><ul><li><a href=https://opentermsarchive.org/en/legal-notice/>Legal notice</a></li><li><a href=https://opentermsarchive.org/en/privacy-policy/>Privacy policy</a></li><li><a href=https://opentermsarchive.org/en/accessibility/>Accessibility: not compliant</a></li></ul></div></div></footer></div></div><script src=/js/languageSwitcher.js></script>
<script src=/js/header.js></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["setExcludedQueryParams",["simulationId","_csrf"]]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://stats.data.gouv.fr/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","179"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><svg aria-hidden="true" id="svgdefs" version="2" xmlns="http://www.w3.org/2000/svg"><defs><symbol id="logo" fill="#010613" viewBox="0 0 406 52"><path d="M92.13 25.546c0-6.187-3.842-9.714-8.855-9.714-5.041.0-8.855 3.527-8.855 9.713.0 6.159 3.814 9.713 8.855 9.713 5.013.0 8.854-3.527 8.854-9.713zm-4.054.0c0 4.007-1.902 6.176-4.801 6.176-2.909.0-4.801-2.17-4.801-6.177s1.892-6.176 4.8-6.176c2.9.0 4.802 2.17 4.802 6.177zM97.301 35h3.998v-6.13h3.36c4.349.0 6.879-2.595 6.879-6.371.0-3.758-2.484-6.408-6.777-6.408h-7.46zm3.998-9.335V19.36h2.696c2.308.0 3.425 1.256 3.425 3.14.0 1.874-1.117 3.167-3.407 3.167zM116.345 35h12.778v-3.296h-8.78v-4.515h8.088v-3.296h-8.088v-4.506h8.743v-3.296h-12.741zm33.946-18.91h-3.98v11.893h-.166l-8.162-11.892h-3.508V35h3.998V23.099h.138L146.838 35h3.453zm13.02 3.297h5.789V35h3.952V19.387h5.789v-3.296h-15.53zM183.609 35h12.778v-3.296h-8.781v-4.515h8.088v-3.296h-8.088v-4.506h8.744v-3.296h-12.741zm18.129.0h3.998v-6.703h2.918L212.236 35h4.414l-4.017-7.35c2.152-.923 3.343-2.797 3.343-5.382.0-3.758-2.484-6.177-6.777-6.177h-7.461zm3.998-9.916v-5.725h2.696c2.309.0 3.426 1.025 3.426 2.909.0 1.874-1.117 2.816-3.407 2.816zm15.275-8.993V35h3.878V22.646h.157l4.893 12.262h2.641l4.893-12.216h.157V35h3.878V16.09h-4.93l-5.208 12.706h-.221l-5.208-12.705zm36.259 5.438h3.831c-.055-3.37-2.825-5.697-7.035-5.697-4.146.0-7.183 2.29-7.165 5.725-.009 2.788 1.958 4.386 5.152 5.152l2.059.517c2.059.498 3.204 1.09 3.213 2.364-.009 1.384-1.32 2.326-3.351 2.326-2.078.0-3.574-.96-3.703-2.853h-3.868c.101 4.09 3.028 6.205 7.617 6.205 4.616.0 7.331-2.207 7.34-5.67-.009-3.148-2.382-4.819-5.669-5.557l-1.699-.407c-1.643-.378-3.019-.988-2.991-2.345.0-1.219 1.08-2.114 3.037-2.114 1.911.0 3.084.868 3.232 2.354zM277.746 35l1.403-4.312h6.823L287.376 35h4.284l-6.519-18.91h-5.151L273.462 35zm2.419-7.433 2.327-7.155h.147l2.327 7.155zM296.146 35h3.998v-6.703h2.917L306.644 35h4.413l-4.016-7.35c2.151-.923 3.342-2.797 3.342-5.382.0-3.758-2.484-6.177-6.777-6.177h-7.46zm3.998-9.916v-5.725h2.696c2.308.0 3.425 1.025 3.425 2.909.0 1.874-1.117 2.816-3.407 2.816zm31.958-2.373c-.526-4.367-3.831-6.879-8.208-6.879-4.995.0-8.808 3.527-8.808 9.713.0 6.168 3.749 9.713 8.808 9.713 4.848.0 7.774-3.222 8.208-6.703l-4.044-.018c-.378 2.022-1.966 3.185-4.099 3.185-2.872.0-4.82-2.133-4.82-6.177.0-3.933 1.921-6.176 4.848-6.176 2.188.0 3.767 1.265 4.071 3.342zM337.179 35h3.998v-7.811h8.116V35h3.988V16.09h-3.988v7.803h-8.116V16.09h-3.998zm25.606-18.91h-3.997V35h3.997zm8.916.0h-4.441L373.788 35h5.152l6.518-18.91h-4.432l-4.579 14.367h-.176zM389.944 35h12.778v-3.296h-8.78v-4.515h8.088v-3.296h-8.088v-4.506h8.743v-3.296h-12.741zM5 31 .67 23.5h8.66z"/><path d="M4.759 25.146c-.962-.034-1.72-.842-1.621-1.799a26 26 0 1112.57 24.998c-.826-.492-1.023-1.583-.477-2.375s1.628-.984 2.46-.501A22.516 22.516.0 106.628 23.47c-.108.956-.908 1.709-1.869 1.675z"/><path d="M23.002 17.631c0-.93.754-1.684 1.684-1.684h12.632a1.684 1.684.0 110 3.369H24.686c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.684 1.684-1.684h9.926a1.684 1.684.0 110 3.368h-9.926c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.684 1.684-1.684h11.632a1.684 1.684.0 010 3.368H24.686c-.93.0-1.684-.754-1.684-1.684zm0 5.895c0-.93.754-1.685 1.684-1.685h3.652a1.684 1.684.0 110 3.369h-3.652c-.93.0-1.684-.754-1.684-1.684z"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#999" style="color:#999" height="1em" width="1em" id="arrowDown"><polyline points="6 9 12 15 18 9"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="close"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></symbol><symbol stroke="currentcolor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#fefffd" style="color:#fefffd" height="1em" width="1em" id="contact"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></symbol><symbol id="mastodon" fill="var(--svgfill)" viewBox="0 0 24 24"><path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792.0 11.813.0h-.03c-3.98.0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057.0 00.023-.043v-1.809a.052.052.0 00-.02-.041.053.053.0 00-.046-.01 20.282 20.282.0 01-4.709.545c-2.73.0-3.463-1.284-3.674-1.818a5.593 5.593.0 01-.319-1.433.053.053.0 01.066-.054c1.517.363 3.072.546 4.632.546.376.0.75.0 1.125-.01 1.57-.044 3.224-.124 4.768-.422.038-.008.077-.015.11-.024 2.435-.464 4.753-1.92 4.989-5.604.008-.145.03-1.52.03-1.67.002-.512.167-3.63-.024-5.545zm-3.748 9.195h-2.561V8.29c0-1.309-.55-1.976-1.67-1.976-1.23.0-1.846.79-1.846 2.35v3.403h-2.546V8.663c0-1.56-.617-2.35-1.848-2.35-1.112.0-1.668.668-1.67 1.977v6.218H4.822V8.102c0-1.31.337-2.35 1.011-3.12.696-.77 1.608-1.164 2.74-1.164 1.311.0 2.302.5 2.962 1.498l.638 1.06.638-1.06c.66-.999 1.65-1.498 2.96-1.498 1.13.0 2.043.395 2.74 1.164.675.77 1.012 1.81 1.012 3.12z"/></symbol></defs></svg></body></html>